<!DOCTYPE html>
<html>
  <script>
    function onFormSubmit() {
      event.preventDefault();
      google.script.run.withSuccessHandler(updatePage).handleFormSubmit(this)
    }
  </script>
  <head>
    <base target="_top">
  </head>
  <body>
    <form id="myForm" onsubmit="event.preventDefault(); google.script.run.withSuccessHandler(updatePage).handleFormSubmit(this)">
      <fieldset name="select-calendar">
        <legend>Select a Google calendar to apply automation on</legend>
        <?!= include('partials/select-calendar.html', { calendars, selectedCalendar }) ?>
      </fieldset>
      <fieldset name="event-colors">
        <legend>Event Color Settings</legend>
        <?!= include('partials/event-colors.html') ?>
      </fieldset>
      <fieldset name="emojifier">
        <legend>Emojifier Settings</legend>
        <?!= include('partials/emojifier.html') ?>
      </fieldset>
      <button type="submit">Submit</button>
    </form>
    <div id="result"></div>
  </body>
  <script>
    function updatePage(result) {
      document.getElementById("result").innerHTML = result;
    }
  </script>
</html>