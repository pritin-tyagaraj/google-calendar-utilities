<!DOCTYPE html>
<html>
  <script>
    function onFormSubmit() {
      event.preventDefault();
      google.script.run.withSuccessHandler(updatePage).handleFormSubmit(this)
    }
  </script>
  <head>
    <base target="_top">
  </head>
  <body>
    <form id="myForm" onsubmit="event.preventDefault(); google.script.run.withSuccessHandler(updatePage).handleFormSubmit(this)">
      <select name="calendar">
        <? for (var i = 0; i < calendars.length; i++) { ?>
          <? if (selectedCalendar == calendars[i].getId()) { ?>
            <option selected value="<?= calendars[i].getId() ?>"><?= calendars[i].getName() ?></option>
          <? } else { ?>
            <option value="<?= calendars[i].getId() ?>"><?= calendars[i].getName() ?></option>
          <? } ?>
        <? } ?>
      </select>
      <button type="submit">Submit</button>
    </form>
    <div id="result"></div>
  </body>
  <script>
    function updatePage(result) {
      document.getElementById("result").innerHTML = result;
    }
  </script>
</html>